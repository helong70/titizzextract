# 批量解压工具使用说明

## 🔧 开发与构建

### 环境要求
- Python 3.8+
- Windows 系统（用于生成注册表文件）

### 项目结构
```
titizz/
├── build_tool.py          # 构建脚本
├── titizz_extract.py      # 主程序源码
├── 7z.exe                 # 7-Zip 命令行工具
├── .venv/                 # 虚拟环境目录
├── dist/                  # 构建输出目录
└── README.md              # 说明文档
```

### 构建步骤
1. **运行构建脚本**
   ```bash
   python build_tool.py
   ```

2. **构建脚本会自动完成以下操作**
   - 🔍 检查并创建虚拟环境（如果不存在）
   - 📦 自动安装 PyInstaller（如果未安装）
   - 📋 验证必要文件存在
   - 🔨 使用 PyInstaller 打包 exe 文件
   - 📝 生成注册表文件
   - 📖 更新使用说明

3. **构建完成后的文件**
   - `dist/titizz_extract.exe` - 可执行文件
   - `add_context_menu.reg` - 添加右键菜单
   - `remove_context_menu.reg` - 移除右键菜单
   - `README.md` - 使用说明（本文件）

### 构建特性
- ✅ **智能环境检测**: 自动检测虚拟环境状态
- ✅ **自动依赖安装**: 缺失 PyInstaller 时自动安装
- ✅ **多镜像源支持**: 自动尝试多个 PyPI 镜像源
- ✅ **错误恢复**: 提供详细的错误信息和解决建议
- ✅ **跨平台兼容**: 支持 Windows/Linux/Mac 开发环境

### 故障排除
如果构建失败，请检查：
1. Python 版本是否为 3.8 或更高
2. 网络连接是否正常
3. 是否有足够的磁盘空间
4. 杀毒软件是否阻止了文件操作

## 📁 文件说明
- `titizz_extract.exe` - 批量解压主程序
- `add_context_menu.reg` - 添加右键菜单的注册表文件
- `remove_context_menu.reg` - 移除右键菜单的注册表文件
- `7z.exe` - 7-Zip 命令行工具（内嵌在 exe 中）

## 🚀 快速开始

### 安装步骤
1. **添加右键菜单**
   - 双击 `add_context_menu.reg` 文件
   - 在弹出的确认对话框中点击"是"
   - 看到"成功添加到注册表"的提示即可

2. **验证安装**
   - 在任意文件夹空白处右键
   - 查看是否出现"批量解压7z文件"选项

### 使用方法
1. **定位到目标文件夹**
   - 进入包含 7z/7zz 压缩文件的文件夹
   - 确保文件夹中有需要解压的压缩包

2. **执行批量解压**
   - 在文件夹空白处右键
   - 选择"批量解压7z文件"
   - 程序会自动开始处理

3. **处理过程**
   - 🔓 自动解压所有 7z 和 7zz 文件（密码: momo.moe）
   - 📁 将所有图片文件收集到 `all_images` 目录
   - 🗑️ 自动清理临时解压文件夹
   - ✅ 显示处理完成信息

### 支持的文件格式
- `.7z` - 7-Zip 压缩文件
- `.7zz` - 7-Zip 压缩文件（新格式）

### 注意事项
- 程序会自动使用密码 `momo.moe` 进行解压
- 解压过程中会创建临时文件夹，完成后会自动删除
- 建议在处理大量文件前备份重要数据

## 🛠️ 高级使用

### 命令行方式
```bash
# 直接在命令行中使用
titizz_extract.exe "C:\目标文件夹路径"

# 或者将 exe 文件拖拽到目标文件夹后执行
```

### 自定义配置
程序目前使用固定密码 `momo.moe`，如需修改请联系开发者或查看源码。

## 🔧 卸载
- 双击 `remove_context_menu.reg` 文件
- 在确认对话框中点击"是"
- 右键菜单中的"批量解压7z文件"选项将被移除

## 📍 安装路径
- 可执行文件: `./dist/titizz_extract.exe`
- 注册表文件: `./add_context_menu.reg` 和 `./remove_context_menu.reg`

## 📋 常见问题

### Q: 右键菜单没有出现怎么办？
A: 
1. 确认已经双击运行了 `add_context_menu.reg`
2. 重启资源管理器：任务管理器 → 结束 `explorer.exe` → 重新运行
3. 检查是否有管理员权限

### Q: 解压失败怎么办？
A:
1. 确认压缩包密码是否为 `momo.moe`
2. 检查压缩包是否损坏
3. 确认有足够的磁盘空间

### Q: 程序运行时出现错误？
A:
1. 确保 Windows 系统版本支持
2. 检查杀毒软件是否拦截
3. 尝试以管理员身份运行

### Q: 如何批量处理多个文件夹？
A: 目前版本需要逐个文件夹处理，未来版本会支持递归处理。

## 🔄 更新日志

### v1.0.0 (2025-09-28)
- ✨ 初始版本发布
- ✅ 支持 7z/7zz 格式批量解压
- ✅ 自动收集图片到 all_images 文件夹
- ✅ 右键菜单集成
- ✅ 自动清理临时文件
- ✅ 智能构建脚本

## 🤝 贡献与反馈

### 问题反馈
如遇到问题或有改进建议，请：
1. 检查本文档的常见问题部分
2. 确保使用最新版本
3. 提供详细的错误信息和复现步骤

### 开发贡献
欢迎提交 Pull Request 或提出改进建议：
- 代码规范：请遵循 PEP 8
- 提交信息：使用清晰的中文描述
- 测试：确保新功能经过充分测试

## 📄 许可证

本项目仅供学习和个人使用，请勿用于商业用途。

---

**构建时间**: 2025年9月28日  
**Python 版本**: 3.8+  
**支持平台**: Windows 10/11
